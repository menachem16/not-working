<style>
.wizard {
    position: fixed;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    z-index: 1000;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .wizard * {
    font-family: 'roboto', 'FontAwesome';
  }
  .wizard_content {
    padding-top: 40px;
    background: white;
    min-height: 410px;
    box-shadow: 0 16px 24px 2px rgba(0, 0, 0, 0.14), 0 6px 30px 5px rgba(0, 0, 0, 0.12), 0 8px 10px -5px rgba(0, 0, 0, 0.2);
    background-color: #FFFFFF;
    width: 100%;
    border-radius: 6px;
    color: rgba(0,0,0, 0.87);
    background: #fff;
  }
  .wizard-navigation {
    position: relative;
  }
  .wizard_header {
    text-align: center;
    font-family: 'roboto';
    font-size: 28px;
    font-weight: bold;
    color: #3C4858;
    text-decoration: none;
  }
  .wizard_second_header {
    text-align: center;
    font-family: 'roboto';
    font-size: 17px;
    color: #3C4858;
    padding: 16px 0px;
    font-weight: 300;
  }
  .blur_background {
    position: fixed;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    z-index: 999;
    backdrop-filter: blur(2px);
    background: #04040459;
  }
  .nav-pills {
    background-color: rgba(200, 200, 200, 0.2);
  }
  .nav-pills > li {
      text-align: center;
      float: left;
      position: relative;
      display: block;
      width: 25%;
  }
  .log_errors:empty {
    display: none;
  }
  .nav-pills > li > a {
    position: relative;
    display: block;
    padding: 10px 15px;
    outline: none;
    border: 0 !important;
    border-radius: 0;
    line-height: 18px;
    text-transform: uppercase;
    font-size: 12px;
    font-weight: 500;
    min-width: 100px;
    text-align: center;
    color: #555555 !important;
    background-color: transparent;
  }
  .nav-pills > li + li {
    margin-left: 0; 
  }
  .nav-pills > li.active > a,
  .nav-pills > li.active > a:hover,
  .nav-pills > li.active > a:focus,
  .nav-pills > li > a:hover,
  .nav-pills > li > a:focus {
    background-color: inherit !important; 
  }
  .nav-pills > li > a {
    user-select: none;
  }
  .nav-pills > li i {
    display: block;
    font-size: 30px;
    padding: 15px 0; 
  }
  .moving-tab {
    transition: all 0.5s cubic-bezier(0.29, 1.42, 0.79, 1) 0s;
    background-color: #f44336;
    box-shadow: 0 16px 26px -10px rgba(244, 67, 54, 0.56), 0 4px 25px 0px rgba(0, 0, 0, 0.12), 0 8px 10px -5px rgba(244, 67, 54, 0.2);
    position: absolute;
    text-align: center;
    padding: 12px;
    font-size: 12px;
    text-transform: uppercase;
    -webkit-font-smoothing: subpixel-antialiased;
    top: -1px;
    left: 0px;
    border-radius: 4px;
    color: #FFFFFF;
    cursor: pointer;
    font-weight: 500;
  }
  .wizard_content * {
    box-sizing: border-box;
  }
  .wizard_body {
    padding: 5px 25px 30px 25px;
  }
  .wizard_tab_body {
    display: none;
  }
  .w_type {
    display: block;
    width: 100%;
    background: #f4f4f4;
    margin: 2px 0px;
    padding: 10px 0px;
    cursor: pointer;
  }
  .w_types_list {
    text-align: center;
    display: flex;
    align-items: center;
    width: 100%;
    flex-wrap: wrap;
    justify-content: center;
    height: 100%;
    padding-top: 30px;
  }
  .w_type:hover {
    color: white;
    background-color: #f44336;
  }
  .reaction_type {
    display: flex !important;
    align-items: center;
    position: relative;
    justify-content: center;
    cursor: pointer;
  }
  .reaction_types {
    margin-top: 20px;
  }
  .reaction_overlay {
    position: absolute;
    left: 0;
    top: 0;
    z-index: 2;
    background: #000000cc;
    width: 100%;
    height: 100%;
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    transition: all 0.1s ease-in;
    opacity: 0;
    pointer-events: none;
    border-radius: 5px;
  }
  .reaction_type:hover .reaction_overlay {
    opacity: 1;
  }
</style>

<div class="row-fluid">
  <div class="box span6 no_border">

    <div class="wizard_frame">
      <div class="wizard_content">
        <div class="wizard_header">Реакции</div>
        <div class="wizard_second_header">Вы можете накрутить реакции на определенные сообщения</div>

        <div class="wizard-navigation">
          <ul class="nav nav-pills">
            <li><a href="#w_type">Тип</a></li>
            <li><a href="#w_message">Сообщение</a></li>
            <li><a href="#w_params">Параметры</a></li>
            <li><a href="#w_preview">Предпросмотр</a></li>
          </ul>
          <div class="moving-tab"></div>
        </div>

        <div class="wizard_body">
          <div class="wizard_tab_body" id="w_type" w_title="Выберите подходящий тип сообщения">
            <div class="row-fluid reaction_types">
              <div class="span6 reaction_type type_vote">
                <div class="reaction_overlay">Сообщение с кнопками</div>
                <img src="images/react_buttons.png" alt="">
              </div>
              <div class="span6 reaction_type type_button">
                <div class="reaction_overlay">Стандартное голосование</div>
                <img src="images/react_vote.png" alt="">
              </div>
            </div>
          </div>

          <div class="wizard_tab_body" id="w_message">
            2
          </div>

          <div class="wizard_tab_body" id="w_params">

            3
          </div>

          <div class="wizard_tab_body" id="w_preview">
            4
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>

class WizardTabs {
  constructor(tab_names) {
    this.current_index = 0;
    this.tabs = [];
    let idx = 0;
    for (let tab of tab_names) {
      this.tabs.push({
        index: idx++,
        id: '#' + tab
      });
    }
    this.openTab('#' + tab_names[0]);
    this.message = {};
  }
  goTab(index){
    let wizard = $('.wizard_content');
    let total = wizard.find('.nav li').length;
    let li_width = 100/total;

    let text = wizard.find(`li:nth-child(${index+1}) > a`).html();
    let total_steps = wizard.find('.nav li').length;
    let move_distance = wizard.width() / total_steps;

    let step_width = move_distance;
    move_distance = move_distance * index;
    let current = index + 1;
    if(current == 1){
        move_distance -= 8;
    } else if(current == total_steps){
        move_distance += 4;
    }
    wizard.find('.moving-tab').css('width', step_width);
    wizard.find('.moving-tab').html(text);
    $('.moving-tab').css({
        'transform':'translate3d(' + move_distance + 'px, 0px, 0)',
        'transition': 'all 0.5s cubic-bezier(0.29, 1.42, 0.79, 1)'
    });
  }
  openTab(id, inner_child) {
    for (let tab of this.tabs) {
      if (tab.id == id) {
        this.goTab(tab.index);
        this.showTabContent(tab.id, inner_child);
      }
    }
  }
  showTabContent(id, inner_child) {
    $('.wizard_tab_body').hide();
    $(id).show();

    if ($(id).attr('w_title') != null) {
      $('.wizard_second_header').html($(id).attr('w_title'));
    }
    if (typeof inner_child !== 'undefined') {
      $(id + ' > [child]').hide();
      $(id).find(`[child=${inner_child}]`).show();
    }
    
  }
}

let tabs = new WizardTabs(['w_type', 'w_message', 'w_params', 'w_preview']);
$('.nav-pills a').on('click', function(e) {
  e.preventDefault();
  tabs.openTab($(this).attr('href'));
});





$("input:checkbox, input:radio").uniform();
$('[rel="tooltip"],[data-rel="tooltip"]').tooltip({"placement":"bottom",delay: { show: 400, hide: 200 }});


$(document).ready(function() {
  WS = new ReconnectingWebSocket("ws://localhost:" + location.port + "/websocket");
  
	WS.onopen = function() {
    loading_stop();
    ws_send({type: 'get_accounts'});
	};

  WS.onclose = function(event) {
    loading_start()
    red_log('Соединение с сервером потеряно');
  };

	WS.onmessage = function (evt) {
	  var data = JSON.parse(evt.data)
	  var f_data = data.data

    ws_defs(evt);

   if (data.type == 'proxy2_check_process') {
      proxy2_check_process(f_data)
   };

   
	};
})

window.onbeforeunload = function() {
  WS.onclose = function () {};
  WS.close();
};
</script>